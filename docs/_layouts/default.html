<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

{% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    
    <style>
      .language-mermaid {
        background-color: transparent !important;
        border: none !important;
        padding: 0 !important;
      }
      
      .mermaid {
        background-color: #fafafa;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        overflow-x: auto;
        border: 1px solid #e0e0e0;
      }
      
      .mermaid svg {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto;
      }
      
      pre code {
        display: block;
        padding: 16px;
        overflow-x: auto;
        background-color: #f6f8fa;
        border: 1px solid #d1d5da;
        border-radius: 6px;
      }
    </style>
  </head>
  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    <header class="page-header" role="banner">
      <h1 class="project-name">{{ page.title | default: site.title | default: site.github.repository_name }}</h1>
      <h2 class="project-tagline">{{ page.description | default: site.description | default: site.github.project_tagline }}</h2>
      {% if site.github.is_project_page %}
        <a href="{{ site.github.repository_url }}" class="btn">View on GitHub</a>
      {% endif %}
      {% if site.show_downloads %}
        <a href="{{ site.github.zip_url }}" class="btn">Download .zip</a>
        <a href="{{ site.github.tar_url }}" class="btn">Download .tar.gz</a>
      {% endif %}
    </header>

    <main id="content" class="main-content" role="main">
      {{ content }}

      <footer class="site-footer">
        {% if site.github.is_project_page %}
          <span class="site-footer-owner"><a href="{{ site.github.repository_url }}">{{ site.github.repository_name }}</a> is maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a>.</span>
        {% endif %}
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </main>
    
    <!-- Load Mermaid dynamically -->
    <script>
      (function() {
        // Load Mermaid script
        var script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js';
        script.onload = function() {
          console.log('Mermaid loaded successfully');
          initializeMermaid();
        };
        script.onerror = function() {
          console.error('Failed to load Mermaid');
        };
        document.head.appendChild(script);
        
        function initializeMermaid() {
          if (typeof mermaid === 'undefined') {
            console.error('Mermaid is not defined');
            return;
          }
          
          // Initialize Mermaid
          mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
              useMaxWidth: true,
              htmlLabels: true,
              curve: 'basis'
            },
            themeVariables: {
              primaryColor: '#4CAF50',
              primaryTextColor: '#fff',
              primaryBorderColor: '#2E7D32',
              lineColor: '#666',
              secondaryColor: '#2196F3',
              tertiaryColor: '#FF9800'
            }
          });
          
          // Find all code blocks with language-mermaid class
          var mermaidBlocks = document.querySelectorAll('pre > code.language-mermaid');
          console.log('Found ' + mermaidBlocks.length + ' mermaid blocks');
          
          mermaidBlocks.forEach(function(block, index) {
            // Get the mermaid code
            var code = block.textContent;
            
            // Create a new div with mermaid class
            var mermaidDiv = document.createElement('div');
            mermaidDiv.className = 'mermaid';
            mermaidDiv.textContent = code;
            
            // Replace the pre > code block with the mermaid div
            block.parentElement.replaceWith(mermaidDiv);
          });
          
          // Now render all mermaid diagrams
          if (mermaidBlocks.length > 0) {
            mermaid.run().then(function() {
              console.log('Mermaid rendered ' + mermaidBlocks.length + ' diagrams successfully');
            }).catch(function(error) {
              console.error('Mermaid rendering error:', error);
            });
          }
        }
        
        // If DOM is already loaded, wait for script load
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function() {
            // Script will load after DOM is ready
          });
        }
      })();
    </script>
  </body>
</html>